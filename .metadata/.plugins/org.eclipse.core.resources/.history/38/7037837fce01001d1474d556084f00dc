/**
* Name: Assignment2
* Based on the internal empty template. 
* Author: Hyesop Shin
* Tags: 
*/


model ExCellularAutomata

global {
  myCA upperLeftCell ;
  init {
    upperLeftCell <- myCA[0,0];
    
    // compute the distance of each cell to the upper left cell
    ask myCA {
      grid_value <- 10 * (self distance_to upperLeftCell);
      //list<myCA> highCells <- myCA where (each.grid_value > 200);
      // assign red color shades according to the distance
      color <- rgb([int(grid_value),0,0]);
    }
  }
}

grid myCA width: 10 height:10 neighbors:8 {
  // diffuse water
  reflex diffusion {
    if grid_value > 50.0 {
      ask neighbors {
        grid_value <- grid_value + 10.0;
      }
    }
    do update_colour;
  } 
  // show grid values in shades of blue
  action update_colour {
    color <- rgb([0,0,int(grid_value)]);    
  }
}


// Define an experiment that visualises the CA 
experiment simulation type: gui {
  output {
    display myMap  {
      grid myCA border:#grey;
    }
  }
}